<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activity Diagram</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;600;700&display=swap');

        body {
            font-family: 'Rajdhani', sans-serif;
            background-color: #0f172a;
            /* Dark Slate */
            color: #f1f5f9;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        #diagram-container {
            position: relative;
            width: 800px;
            height: 900px;
            border-radius: 20px;
            overflow: hidden;
            /* Capture clean */
            background-color: #0f172a;
            /* Solid BG for export */
            margin-top: 20px;
        }

        /* Background Grid */
        .bg-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        /* Nodes */
        .node {
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #1e293b;
            color: #e2e8f0;
            font-weight: bold;
            font-size: 14px;
            border: 2px solid #38bdf8;
            z-index: 2;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        /* Activity (Rounded Rect) */
        .activity {
            width: 140px;
            height: 50px;
            border-radius: 25px;
            /* Fully rounded ends */
        }

        /* Decision (Diamond) */
        .decision {
            width: 40px;
            height: 40px;
            transform: rotate(45deg);
            border-color: #fbbf24;
            /* Amber */
            background: #1e293b;
        }

        .decision-label {
            transform: rotate(-45deg);
            font-size: 11px;
            width: 60px;
            position: absolute;
        }

        /* Start/End */
        .start-node {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #4ade80;
            /* Green */
            border: none;
        }

        .end-node {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 4px solid #ef4444;
            /* Red border */
            background: transparent;
        }

        .end-inner {
            width: 14px;
            height: 14px;
            background: #ef4444;
            border-radius: 50%;
        }

        /* Text Labels on Lines */
        .line-label {
            position: absolute;
            background: #0f172a;
            color: #94a3b8;
            font-size: 12px;
            padding: 2px 5px;
            z-index: 3;
        }

        /* Positions - Vertical Flow */
        /* Center X = 400 */

        #start {
            top: 40px;
            left: 385px;
        }

        #act1 {
            top: 100px;
            left: 330px;
        }

        /* Login */

        #act2 {
            top: 180px;
            left: 330px;
        }

        /* View Drives */

        #act3 {
            top: 260px;
            left: 330px;
        }

        /* Select Job */

        #dec1 {
            top: 350px;
            left: 380px;
        }

        /* Eligible? */

        #act4_no {
            top: 350px;
            left: 550px;
            border-color: #ef4444;
        }

        /* Not Eligible */

        #act5 {
            top: 450px;
            left: 330px;
            border-color: #a855f7;
        }

        /* AI Analysis */

        #act6 {
            top: 540px;
            left: 330px;
        }

        /* Submit App */

        #act7 {
            top: 620px;
            left: 330px;
        }

        /* Save DB */

        #dec2 {
            top: 710px;
            left: 380px;
        }

        /* Success? */

        #end {
            top: 820px;
            left: 385px;
        }


        .controls {
            position: absolute;
            bottom: 30px;
            z-index: 10;
        }

        button {
            padding: 12px 30px;
            background: #0284c7;
            color: white;
            border: none;
            border-radius: 6px;
            font-family: 'Rajdhani', sans-serif;
            font-weight: bold;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s;
        }
    </style>
</head>

<body>

    <div id="diagram-container">

        <div class="bg-grid"></div>

        <!-- SVG Arrows Layer -->
        <!-- Explicitly styled for html2canvas -->
        <svg xmlns="http://www.w3.org/2000/svg" width="800" height="900"
            style="position:absolute; top:0; left:0; pointer-events:none; z-index:1;">

            <!-- Start -> Login -->
            <path d="M 400 70 L 400 100" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 395 90 L 400 100 L 405 90" stroke="#cbd5e1" stroke-width="2" fill="none" />

            <!-- Login -> View -->
            <path d="M 400 150 L 400 180" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 395 170 L 400 180 L 405 170" stroke="#cbd5e1" stroke-width="2" fill="none" />

            <!-- View -> Select -->
            <path d="M 400 230 L 400 260" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 395 250 L 400 260 L 405 250" stroke="#cbd5e1" stroke-width="2" fill="none" />

            <!-- Select -> Decision -->
            <path d="M 400 310 L 400 350" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 395 340 L 400 350 L 405 340" stroke="#cbd5e1" stroke-width="2" fill="none" />

            <!-- Decision -> No (Right) -->
            <path d="M 420 370 L 550 370" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 540 365 L 550 370 L 540 375" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <text x="450" y="365" fill="#ef4444" font-size="12" font-family="sans-serif">No</text>

            <!-- Decision -> Yes (Down) -->
            <path d="M 400 390 L 400 450" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 395 440 L 400 450 L 405 440" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <text x="405" y="420" fill="#4ade80" font-size="12" font-family="sans-serif">Yes</text>

            <!-- No -> End (Curve) -->
            <path d="M 620 395 Q 620 835 415 835" stroke="#cbd5e1" stroke-width="2" fill="none"
                stroke-dasharray="4,4" />
            <path d="M 425 830 L 415 835 L 425 840" stroke="#cbd5e1" stroke-width="2" fill="none" />

            <!-- AI -> Submit -->
            <path d="M 400 500 L 400 540" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 395 530 L 400 540 L 405 530" stroke="#cbd5e1" stroke-width="2" fill="none" />

            <!-- Submit -> Save -->
            <path d="M 400 590 L 400 620" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 395 610 L 400 620 L 405 610" stroke="#cbd5e1" stroke-width="2" fill="none" />

            <!-- Save -> Dec2 -->
            <path d="M 400 670 L 400 710" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 395 700 L 400 710 L 405 700" stroke="#cbd5e1" stroke-width="2" fill="none" />

            <!-- Dec2 -> End (Down) -->
            <path d="M 400 750 L 400 820" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <path d="M 395 810 L 400 820 L 405 810" stroke="#cbd5e1" stroke-width="2" fill="none" />
            <text x="405" y="780" fill="#4ade80" font-size="12" font-family="sans-serif">Success</text>

        </svg>

        <!-- Node Elements -->
        <div id="start" class="node start-node"></div>

        <div id="act1" class="node activity">Login</div>
        <div id="act2" class="node activity">View Drives</div>
        <div id="act3" class="node activity">Select Job</div>

        <div id="dec1" class="node decision">
            <span class="decision-label">Eligible?</span>
        </div>

        <div id="act4_no" class="node activity" style="width:100px;">Show Error</div>

        <div id="act5" class="node activity">AI Analysis</div>
        <div id="act6" class="node activity">Submit App</div>
        <div id="act7" class="node activity">Save to DB</div>

        <div id="dec2" class="node decision">
            <span class="decision-label">Saved?</span>
        </div>

        <div id="end" class="node end-node">
            <div class="end-inner"></div>
        </div>

    </div>

    <div class="controls">
        <button onclick="downloadImage()">Download Activity Diagram</button>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        function downloadImage() {
            const element = document.body;
            document.querySelector('.controls').style.display = 'none';
            html2canvas(element, { scale: 3 }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'Activity_Diagram.png';
                link.href = canvas.toDataURL();
                link.click();
                document.querySelector('.controls').style.display = 'block';
            });
        }
    </script>
</body>

</html>